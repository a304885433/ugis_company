(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-57fe3cac"],{"4e41":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-form",{staticClass:"form",attrs:{form:e.form,submit:e.handleSubmit}},[r("a-form-item",{attrs:{label:"企业"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyId",{rules:[{required:!0,message:"请选择企业"}]}],expression:"[ 'companyId',\n                              {rules: [{ required: true, message: '请选择企业'}]}\n                            ]"}],attrs:{placeholder:"请选择企业"},on:{change:e.handleCompanyChange}},e._l(e.companyArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1),r("a-form-item",{attrs:{label:"说明"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"['remark' ]"}],attrs:{placeholder:"请输入说明"}})],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"图片",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["file",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:[{validator:e.validateFile}]}],expression:"['file', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\nrules: [{ validator: validateFile }]\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture-card"},on:{preview:e.handlePreview,change:e.handleChange}},[r("a-button",[r("div",[r("a-icon",{attrs:{type:"plus"}})],1)])],1)],1)],1),r("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[r("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})]),r("footer-tool-bar",{style:{width:e.isSideMenu()&&e.isDesktop()?"calc(100% - "+(e.sidebarOpened?256:80)+"px)":"100%"}},[r("a-button",{directives:[{name:"action",rawName:"v-action",value:["create","update"],expression:"['create','update']"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:e.loading},on:{click:e.handleSubmit}},[e._v("提交")]),r("a-button",{attrs:{type:"default"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},n=[],i=(r("ac4d"),r("8a81"),r("ac6a"),r("7f7f"),r("5a70")),o=r("ac0d"),l=r("365c"),s={name:"UserEdit",mixins:[o["b"],o["c"]],components:{FooterToolBar:i["a"]},props:{companyArr:{type:Array}},data:function(){return{errors:[],form:this.$form.createForm(this),loading:!1,mdl:null,roles:[],previewImage:"",previewVisible:!1,formItemLayout:{labelCol:{md:2,align:"left",xs:24},wrapperCol:{md:14,offset:2,xs:24}}}},created:function(){this.companyArr=this.$route.params.companyArr},methods:{handleSubmit:function(){var e=this;this.form.validateFields(function(t,r){if(!t){e.loading=!0;var a=e.getUploadFile(r.file);return l["b"].Create({remark:r.remark,companyId:r.companyId,files:a}).then(function(){e.$router.go(-1)}).finally(function(){e.loading=!1})}})},normFile:function(e){return Array.isArray(e)?e:e&&e.fileList},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0},filePreview:function(e){var t=this.$createElement,r=e.url,a=e.ext;if(!r&&e.response){var n=e.response.result;if(!n||!n.uid)return;a=n.ext,r="http://".concat(location.host,"/api/file/download?id=").concat(n.uid,"&name=").concat(n.name)}a=a.toLowerCase(),".jpg"==a||".png"==a||".bmp"==a||".jpeg"==a?this.$success({title:null,width:600,okText:"确定",content:t("div",[t("img",{style:"width:500px;",attrs:{src:r}})])}):window.open(r,"_blank")},parseFile:function(e){if(!e)return[];var t=JSON.parse(e);return t.filter(function(e){return null!=e}).map(function(e){return e.status="done",e.url="http://".concat(location.host,"/api/file/download?id=").concat(e.uid,"&name=").concat(e.name),e})},validateFile:function(e,t,r){if(t){var a=!0,n=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value;if("error"==s.status){var c=s.size/1024/1024<10;if(!c)return void r(new Error("".concat(s.name," 不能超过 10M ")));r(new Error("".concat(s.name," 上传失败 ")))}if(s.percent<100)return void r(new Error("上传中..."))}}catch(u){n=!0,i=u}finally{try{a||null==l.return||l.return()}finally{if(n)throw i}}r()}else r(new Error("至少上传一张图片..."))},handleChange:function(e){var t=e.fileList;this.fileList=t},getUploadFile:function(e){if(!e||!e.length)return null;var t=e.map(function(e){if("done"!=e.status)throw new Error("存在未成功上传的文件，请检查！");return e.response?e.response.result:e});return JSON.stringify(t)}}},c=s,u=(r("eb2c"),r("2877")),d=Object(u["a"])(c,a,n,!1,null,null,null);t["default"]=d.exports},baca:function(e,t,r){},eb2c:function(e,t,r){"use strict";var a=r("baca"),n=r.n(a);n.a}}]);