(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28b1c637"],{2924:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-form",{attrs:{layout:"inline",form:e.form}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"摘要"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],attrs:{placeholder:"摘要"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"上传日期"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["startTime"],expression:"[\n                'startTime'\n              ]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"-",colon:!1}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["endTime"],expression:"[\n                'endTime',\n              ]"}],staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"}})],1)],1),a("a-col",{attrs:{md:24,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.handleQuery(1)}}},[e._v("查询")]),a("router-link",{attrs:{to:{name:"FileEdit"}}},[a("a-button",{directives:[{name:"action",rawName:"v-action:create",arg:"create"}],attrs:{type:"primary",icon:"plus"}},[e._v("新建")])],1)],1)])],1)],1)],1),a("a-list",{attrs:{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:6},dataSource:e.list},scopedSlots:e._u([{key:"renderItem",fn:function(t,i){return a("a-list-item",{},[a("a-card",{staticClass:"card-item",attrs:{hoverable:""},on:{click:function(a){return e.handlePreview(t)}}},[a("img",{staticClass:"img-item",attrs:{slot:"cover",alt:t.remark,src:t.src},slot:"cover"}),a("a-card-meta",[a("template",{slot:"description"},[a("a-popover",{attrs:{content:t.remark}},[a("div",{staticClass:"img-desp"},[e._v("\n                "+e._s(t.remark)+"\n              ")])])],1)],2),e.hasP?a("template",{staticClass:"ant-card-actions",slot:"actions"},[a("a-icon",{directives:[{name:"action",rawName:"v-action:update",arg:"update"}],attrs:{type:"edit"},on:{click:function(a){return a.stopPropagation(),e.handleEditImg(t)}}}),a("a-popconfirm",{attrs:{title:"删除不可恢复，是否继续？"},on:{confirm:function(a){return e.handleDelete(t)}}},[a("a-icon",{directives:[{name:"action",rawName:"v-action:delete",arg:"delete"}],attrs:{type:"delete"},on:{click:function(a){return a.stopPropagation(),e.removeImg(t)}}})],1)],1):e._e()],2)],1)}}])}),a("p"),a("a-pagination",{attrs:{defaultCurrent:1,total:e.total,pageSize:e.pageSize,current:e.pageIndex},on:{change:e.handleQuery}}),a("a-modal",{attrs:{visible:e.previewVisible,footer:null},on:{cancel:e.handleCancel}},[a("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}}),e.curr?a("div",[e._v("\n      "+e._s(e.curr.remark)+"\n    ")]):e._e()]),a("a-modal",{attrs:{visible:e.editVisible},on:{cancel:e.handleCancelImg,ok:e.handleSaveImg}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.imgDesp,expression:"imgDesp"}],staticStyle:{width:"95%"},attrs:{type:"text"},domProps:{value:e.imgDesp},on:{input:function(t){t.target.composing||(e.imgDesp=t.target.value)}}})])],1)},n=[],r=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("365c")),s=a("c1df"),o=a.n(s),l={name:"FileList",components:{},data:function(){return{form:this.$form.createForm(this),visible:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},mdl:{},advanced:!1,loadData:function(e){return r["b"].GetAll(e).then(function(e){var t=!0,a=!1,i=void 0;try{for(var n,r=e.result.items[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;s.src="http://".concat(location.host,"/api/file/download?id=").concat(s.uId,"&name=").concat(s.name)}}catch(o){a=!0,i=o}finally{try{t||null==r.return||r.return()}finally{if(a)throw i}}return e.result})},list:[],total:0,previewVisible:!1,previewImage:null,pageIndex:1,pageSize:12,loading:!1,imgDesp:null,curr:null,editVisible:!1,hasP:!1}},created:function(){this.handleQuery(1),this.hasP=window.abp.auth.hasPermission("CompanyFile.update")||window.abp.auth.hasPermission("CompanyFile.delete")},methods:{handleEdit:function(e){this.$router.push({name:"UserEdit",query:{id:e.id}})},handleQuery:function(e,t){var a=this;this.pageIndex=e,this.form.validateFields(function(e,t){e||(t.startTime&&(t.startTime=o()(t.startTime).format("YYYY-MM-DD 00:00:00")),t.endTime&&(t.endTime=o()(t.endTime).format("YYYY-MM-DD 23:59:59")),t.skipCount=(a.pageIndex-1)*a.pageSize,a.loading=!0,a.loadData(t).then(function(e){a.list=e.items,a.total=e.totalCount}).finally(function(){a.loading=!1}))})},handlePageChange:function(e){this.pageIndex=e,this.handleQuery(e)},handleDelete:function(e){var t=this;r["b"].Delete({id:e.id}).then(function(){t.$message.success("删除成功"),t.handleQuery(1)})},onChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},toggleAdvanced:function(){this.advanced=!this.advanced},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.curr=e,this.previewImage=e.src,this.previewVisible=!0},removeImg:function(){},handleEditImg:function(e){this.curr=e,this.imgDesp=e.remark,this.editVisible=!0},handleCancelImg:function(e){this.editVisible=!1},handleSaveImg:function(){var e=this;r["b"].Update({id:this.curr.id,remark:this.imgDesp}).then(function(){e.$message.success("修改成功"),e.handleQuery(e.pageIndex),e.editVisible=!1}).catch(function(t){var a=t.response.data;e.$message.error("修改失败 ".concat(a.error.message))})}}},c=l,d=(a("f193"),a("2877")),m=Object(d["a"])(c,i,n,!1,null,"02285c6a",null);t["default"]=m.exports},"54fc":function(e,t,a){},f193:function(e,t,a){"use strict";var i=a("54fc"),n=a.n(i);n.a}}]);