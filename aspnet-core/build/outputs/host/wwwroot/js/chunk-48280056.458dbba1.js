(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48280056"],{"629f":function(t,e,r){"use strict";var n=r("7d8d"),a=r.n(n);a.a},"75fc":function(t,e,r){"use strict";var n=r("a745"),a=r.n(n);function o(t){if(a()(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}var i=r("774e"),s=r.n(i),c=r("c8bb"),l=r.n(c);function u(t){if(l()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return s()(t)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return o(t)||u(t)||d()}r.d(e,"a",function(){return f})},"774e":function(t,e,r){t.exports=r("d2d5")},"7d8d":function(t,e,r){},a21f:function(t,e,r){var n=r("584a"),a=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return a.stringify.apply(a,arguments)}},a356:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a-card",{staticClass:"card",attrs:{title:"",bordered:!1}},[r("check-info",{ref:"checkInfoForm",attrs:{companyArr:t.companyArr,dianweiDicArr:t.dianweiDicArr}})],1),r("a-card",{attrs:{title:""}},[r("check-item",{ref:"checkItemTable"})],1),r("footer-tool-bar",{style:{width:t.isSideMenu()&&t.isDesktop()?"calc(100% - "+(t.sidebarOpened?256:80)+"px)":"100%"}},[r("span",{staticClass:"popover-wrapper"},[r("a-popover",{attrs:{title:"表单校验信息",overlayClassName:"antd-pro-pages-forms-style-errorPopover",trigger:"click",getPopupContainer:function(t){return t.parentNode}}},[r("template",{slot:"content"},t._l(t.errors,function(e){return r("li",{key:e.key,staticClass:"antd-pro-pages-forms-style-errorListItem",on:{click:function(r){return t.scrollToField(e.key)}}},[r("a-icon",{staticClass:"antd-pro-pages-forms-style-errorIcon",attrs:{type:"cross-circle-o"}}),r("div",{},[t._v(t._s(e.message))]),r("div",{staticClass:"antd-pro-pages-forms-style-errorField"},[t._v(t._s(e.fieldLabel))])],1)}),0),t.errors.length>0?r("span",{staticClass:"antd-pro-pages-forms-style-errorIcon"},[r("a-icon",{attrs:{type:"exclamation-circle"}}),t._v(t._s(t.errors.length)+"\n        ")],1):t._e()],2)],1),r("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:t.loading},on:{click:t.validate}},[t._v("提交")]),r("a-button",{attrs:{type:"default"},on:{click:function(e){return t.$router.go(-1)}}},[t._v("取消")])],1)],1)},a=[],o=r("a4bb"),i=r.n(o),s=r("cebc"),c=r("5176"),l=r.n(c),u=r("f499"),d=r.n(u),f=r("5d73"),m=r.n(f),p=r("75fc"),h=r("5a70"),y=r("ac0d"),v=r("365c"),g=r("c1df"),k=r.n(g),b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-form",{staticClass:"form",attrs:{form:t.form},on:{submit:t.handleSubmit}},[r("a-table",{attrs:{columns:t.columns,dataSource:t.data,pagination:!1,loading:t.memberLoading},scopedSlots:t._u([{key:"poluTypeId",fn:function(e,n){return[r("a-select",{staticStyle:{width:"100%"},model:{value:n.poluTypeId,callback:function(e){t.$set(n,"poluTypeId",e)},expression:"record.poluTypeId"}},t._l(t.poluTypeArr,function(e){return r("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)]}},{key:"concentration",fn:function(e,n){return[r("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,step:1},model:{value:n.concentration,callback:function(e){t.$set(n,"concentration",e)},expression:"record.concentration"}})]}},{key:"operation",fn:function(e,n){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(e){return t.remove(n.key)}}},[r("a",[t._v("删除")])])]}}])}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:t.handleAdd}},[t._v("新增")])],1)},w=[],I=r("2b0e"),T=new I["a"],C={name:"CheckItem",data:function(){return{form:null,memberLoading:!1,columns:[{title:"因子",dataIndex:"poluTypeId",width:"20%",scopedSlots:{customRender:"poluTypeId"}},{title:"浓度",dataIndex:"concentration",width:"30%",scopedSlots:{customRender:"concentration"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],poluTypeArr:[]}},created:function(){var t=this;this.form=this.$form.createForm(this),T.$on("GetCompanyPoluType",function(e){t.poluTypeArr=e;var r=!0,n=!1,a=void 0;try{for(var o,i=m()(t.data);!(r=(o=i.next()).done);r=!0){var s=o.value;s.poluTypeId=null}}catch(c){n=!0,a=c}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}})},methods:{edit:function(t){this.data=t.map(function(t,e){return t.key=e,t})},handleSubmit:function(t){t.preventDefault(),this.form.validateFields(function(t,e){})},handleAdd:function(){this.data.push({key:this.data.length,poluTypeId:null,concentration:null})},remove:function(t){this.data.splice(t,1)}}},x=C,_=r("2877"),A=Object(_["a"])(x,b,w,!1,null,null,null),S=A.exports,F=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("a-form",{staticClass:"form",attrs:{form:t.form},on:{submit:t.handleSubmit}},[r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"企业"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyId",{rules:[{required:!0,message:"请选择企业"}]}],expression:"[ 'companyId',\n                      {rules: [{ required: true, message: '请选择企业'}]}\n                    ]"}],attrs:{placeholder:"请选择企业"},on:{change:t.handleCompanyChange}},t._l(t.companyArr,function(e){return r("a-select-option",{key:e.id,attrs:{chkPointId:e.chkPointIdList,value:e.id},on:{change:t.handleCompanyChange}},[t._v(t._s(e.name))])}),1)],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"排查点位"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkPointId",{rules:[{required:!0,message:"请选择排查点位"}]}],expression:"[ 'chkPointId',\n                      {rules: [{ required: true, message: '请选择排查点位'}]}\n                    ]"}],attrs:{placeholder:"排查点位"}},t._l(t.chkPointArr,function(e){return r("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1)],1)],1),r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"记录日期"}},[r("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkDate",{rules:[{required:!0,message:"请输入记录日期"}]}],expression:"[ 'chkDate', {rules: [{ required: true, message: '请输入记录日期'}]} ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入记录日期"}})],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"记录员"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkUserName",{rules:[{required:!0,message:"请输入记录员"}]}],expression:"[ 'chkUserName',\n                              {rules: [{ required: true, message: '请输入记录员'}]}\n                            ]"}],attrs:{placeholder:"记录员"}})],1)],1)],1),r("a-form-item",{attrs:{label:"排查批次"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkBatch"],expression:"[ 'chkBatch']"}],attrs:{placeholder:"排查批次"}})],1)],1)},P=[],$={name:"TaskForm",props:{showSubmit:{type:Boolean,default:!1},companyArr:{type:Array}},data:function(){return{form:this.$form.createForm(this),chkPointArr:[],poluTypeArr:[]}},created:function(){this.form.getFieldDecorator("chkUserName",{initialValue:this.$store.getters.nickname}),this.form.getFieldDecorator("chkDate",{initialValue:k()()})},methods:{handleSubmit:function(t){t.preventDefault()},edit:function(t){var e=this;this.form.resetFields(),setTimeout(function(){e.form.setFieldsValue(Object(s["a"])({},t))},50)},handleCompanyChange:function(t,e){var r=e.data.attrs.chkPointId||"0";this.form.setFieldsValue({chkPointId:null}),this.getChkPoint(r),this.getPoluType(t)},getChkPoint:function(t){var e=this;v["c"].GetAllItem({idList:t}).then(function(t){e.chkPointArr=t.result.filter(function(t){return"dianweixinxi"==t.typeCode})})},getPoluType:function(t){var e=this;v["b"].GetPoluType({id:t}).then(function(t){e.poluTypeArr=t.result,T.$emit("GetCompanyPoluType",e.poluTypeArr)})}}},D=$,N=Object(_["a"])(D,F,P,!1,null,"2d276334",null),O=N.exports,L={name:"CompanyEditIndex",mixins:[y["b"],y["c"]],components:{FooterToolBar:h["a"],CheckItem:S,CheckInfo:O},data:function(){return{description:"录入排查数据",loading:!1,memberLoading:!1,errors:[],dicArr:[],dianweiDicArr:[],companyArr:[]}},created:function(){this.getCompanyInfo()},methods:{clearData:function(){this.$nextTick(function(){})},getCompanyInfo:function(){var t=this;return v["b"].GetAllItem().then(function(e){t.companyArr=e.result})},handleSubmit:function(t){t.preventDefault()},handleChange:function(t,e,r){var n=Object(p["a"])(this.data),a=n.filter(function(t){return e===t.key})[0];a&&(a[r]=t,this.data=n)},checkTableData:function(t,e,r){if(!t||!t.length)return!0;var n=!0,a=!1,o=void 0;try{for(var i,s=m()(t);!(n=(i=s.next()).done);n=!0){var c=i.value;if(""===c[e]||null===c[e]||void 0===c[e])return this.$notification.warn({message:"提示",description:r}),!1}}catch(l){a=!0,o=l}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return!0},getUploadFile:function(t){if(!t||!t.length)return null;var e=t.map(function(t){return t.response?t.response.result:t});return d()(e)},validate:function(){var t=this,e=this.$refs,r=e.checkInfoForm,n=e.checkItemTable,a=this.$notification,o=n.data;r.form.validateFields(function(e,n){if(e){var i=l()({},r.form.getFieldsError()),c=Object(s["a"])({},i);t.errorList(c)}else if(0==o.length&&t.$notification.warn({message:"未填写因子排查数据"}),t.checkTableData(o,"poluTypeId","因子数据不完整，请调整！"))return n.poluTypeList=o,v["a"].SaveForEdit(n).then(function(e){t.$message.info("保存成功"),t.$router.go(-1)}).catch(function(t){a.error({message:"保存失败，请稍后重试！",description:t.message})})})},errorList:function(t){if(!t||0===t.length)return null;this.errors=i()(t).map(function(e){return t[e]?{key:e,message:t[e][0]}:null})},scrollToField:function(t){var e=document.querySelector('label[for="'.concat(t,'"]'));e&&e.scrollIntoView(!0)}}},j=L,q=(r("629f"),Object(_["a"])(j,n,a,!1,null,"333d543c",null));e["default"]=q.exports},c8bb:function(t,e,r){t.exports=r("54a1")},f499:function(t,e,r){t.exports=r("a21f")}}]);