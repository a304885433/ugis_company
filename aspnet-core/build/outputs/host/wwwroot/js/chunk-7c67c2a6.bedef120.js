(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7c67c2a6"],{2045:function(e,t,r){},"24d0":function(e,t,r){"use strict";var a=r("f409"),i=r.n(a);i.a},"251e":function(e,t,r){},5862:function(e,t,r){},"75fc":function(e,t,r){"use strict";var a=r("a745"),i=r.n(a);function n(e){if(i()(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}var o=r("774e"),s=r.n(o),l=r("c8bb"),c=r.n(l);function u(e){if(c()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return s()(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){return n(e)||u(e)||d()}r.d(t,"a",function(){return m})},"774e":function(e,t,r){e.exports=r("d2d5")},a179:function(e,t,r){"use strict";var a=r("5862"),i=r.n(a);i.a},a21f:function(e,t,r){var a=r("584a"),i=a.JSON||(a.JSON={stringify:JSON.stringify});e.exports=function(e){return i.stringify.apply(i,arguments)}},aef7:function(e,t,r){"use strict";var a=r("e659"),i=r.n(a);i.a},c8bb:function(e,t,r){e.exports=r("54a1")},d605:function(e,t,r){"use strict";var a=r("2045"),i=r.n(a);i.a},d9ad:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-card",{staticClass:"card",attrs:{title:"基本信息",bordered:!1}},[r("base-info",{ref:"baseInfoForm",attrs:{showSubmit:!1,waterDicArr:e.waterDicArr}})],1),r("a-card",{staticClass:"card",attrs:{title:"排污信息",bordered:!1}},[r("water-info",{ref:"waterInfoForm",attrs:{showSubmit:!1,paifangDicArr:e.paifangDicArr,shoujiDicArr:e.shoujiDicArr,dianweiDicArr:e.dianweiDicArr}})],1),r("a-card",{attrs:{title:"污染因子"}},[r("polu-type",{ref:"poluTypeTable",attrs:{yinziDicArr:e.yinziDicArr}})],1),r("a-card",{attrs:{title:"药品及污染源购置台账"}},[r("yao-pin",{ref:"yaopinTable",attrs:{yaopinDicArr:e.yaopinDicArr}})],1),r("footer-tool-bar",{style:{width:e.isSideMenu()&&e.isDesktop()?"calc(100% - "+(e.sidebarOpened?256:80)+"px)":"100%"}},[r("span",{staticClass:"popover-wrapper"},[r("a-popover",{attrs:{title:"表单校验信息",overlayClassName:"antd-pro-pages-forms-style-errorPopover",trigger:"click",getPopupContainer:function(e){return e.parentNode}}},[r("template",{slot:"content"},e._l(e.errors,function(t){return r("li",{key:t.key,staticClass:"antd-pro-pages-forms-style-errorListItem",on:{click:function(r){return e.scrollToField(t.key)}}},[r("a-icon",{staticClass:"antd-pro-pages-forms-style-errorIcon",attrs:{type:"cross-circle-o"}}),r("div",{},[e._v(e._s(t.message))]),r("div",{staticClass:"antd-pro-pages-forms-style-errorField"},[e._v(e._s(t.fieldLabel))])],1)}),0),e.errors.length>0?r("span",{staticClass:"antd-pro-pages-forms-style-errorIcon"},[r("a-icon",{attrs:{type:"exclamation-circle"}}),e._v(e._s(e.errors.length)+"\n        ")],1):e._e()],2)],1),r("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:e.loading},on:{click:e.validate}},[e._v("提交")]),r("a-button",{attrs:{type:"default"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},i=[],n=r("a4bb"),o=r.n(n),s=r("cebc"),l=r("5176"),c=r.n(l),u=r("f499"),d=r.n(u),m=r("5d73"),p=r.n(m),f=r("75fc"),h=r("e814"),v=r.n(h),y=(r("28a5"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-form-item",{attrs:{label:"企业名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入企业名称",whitespace:!0}]}],expression:"[\n                                  'name',\n                                  {rules: [{ required: true, message: '请输入企业名称', whitespace: true}]}\n                                ]"}],attrs:{placeholder:"请输入企业名称"}})],1),r("a-form-item",{attrs:{label:"企业地址"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入企业地址",whitespace:!0}]}],expression:"[\n                          'address',\n                          {rules: [{ required: true, message: '请输入企业地址', whitespace: true}]}\n                        ]"}],attrs:{placeholder:"请输入企业地址"}})],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"企业联系人"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact",{rules:[{required:!0,message:"请输入企业联系人",whitespace:!0}]}],expression:"[\n                    'contact',\n                    {rules: [{ required: true, message: '请输入企业联系人', whitespace: true}]}\n                  ]"}],attrs:{placeholder:"请输入"}})],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"联系电话"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["tel",{rules:[{required:!0,message:"请输入联系电话",whitespace:!0}]}],expression:"[\n             'tel',\n             {rules: [{ required: true, message: '请输入联系电话', whitespace: true}]}\n           ]"}],attrs:{placeholder:"请输入联系电话"}})],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"排污许可证"}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["licenseFile",{valuePropName:"fileList",getValueFromEvent:e.normFile}],expression:"['licenseFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{xs:24,md:12}},[r("a-form-item",{attrs:{label:"废水类型"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["waterTypeID",{rules:[{required:!0,message:"请选择废水类型"}]}],expression:"[\n                    'waterTypeID',\n                    {rules: [{ required: true, message: '请选择废水类型'}]}\n                  ]"}],attrs:{placeholder:"请选择废水类型"}},e._l(e.waterDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-col",{attrs:{xs:24,md:12}},[r("a-form-item",{attrs:{label:"废水月处理量"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["waterAmount",{rules:[{required:!0,message:"请输入废水月处理量"}]}],expression:"[\n                        'waterAmount',\n                        {rules: [{ required: true, message: '请输入废水月处理量'}]}\n                      ]"}],attrs:{placeholder:"请输入废水月处理量"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("吨\n            ")])])],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"污水处理工艺流程图",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["craftFile",{valuePropName:"fileList",getValueFromEvent:e.normFile}],expression:"['craftFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-form-item",{attrs:{label:"工艺流程说明（要说明污水分流情况）"}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["craftDes"],expression:"[\n                      'craftDes'\n                    ]"}],attrs:{placeholder:""}})],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"污水管网图",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["pipeFile",{valuePropName:"fileList",getValueFromEvent:e.normFile}],expression:"['pipeFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"环境污染险保单复印件",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["issSheetFile",{valuePropName:"fileList",getValueFromEvent:e.normFile}],expression:"['issSheetFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{md:12,xs:24}},[r("a-form-item",{attrs:{label:"环评公司名称",extra:""}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["envCompany",{rules:[{required:!0,message:"请输入环评公司名称",whitespace:!0}]}],expression:"[\n               'envCompany',\n               {rules: [{ required: true, message: '请输入环评公司名称', whitespace: true}]}\n             ]"}],attrs:{placeholder:"请输入环评公司名称"}})],1)],1),r("a-col",{attrs:{md:12,xs:24}},[r("a-form-item",{attrs:{label:"企业危险评级"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["riskBand",{rules:[{required:!0,message:"请选择企业危险评级"}]}],expression:"[\n                     'riskBand',\n                     {rules: [{ required: true, message: '请选择企业危险评级'}]}\n                   ]"}],attrs:{placeholder:"请选择企业危险评级"}},[r("a-select-option",{attrs:{value:"1"}},[e._v("1")]),r("a-select-option",{attrs:{value:"2"}},[e._v("2")]),r("a-select-option",{attrs:{value:"3"}},[e._v("3")]),r("a-select-option",{attrs:{value:"4"}},[e._v("4")]),r("a-select-option",{attrs:{value:"5"}},[e._v("5")]),r("a-select-option",{attrs:{value:"6"}},[e._v("6")])],1)],1)],1)],1),e.showSubmit?r("a-form-item",[r("a-button",{attrs:{htmlType:"submit"}},[e._v("保存")])],1):e._e()],1)}),g=[],b=(r("7f7f"),r("a745")),w=r.n(b),F={name:"BaseInfo",props:{showSubmit:{type:Boolean,default:!1},waterDicArr:{type:Array}},data:function(){return{form:this.$form.createForm(this),formItemLayout:{labelCol:{md:2,align:"left",xs:24},wrapperCol:{md:14,offset:2,xs:24}},dicArr:[],fileList:[{uid:"-1",name:"xxx.png",status:"done",url:"https://zos.alipayobjects.com/rmsportal/jkjgkEfvpUPVyRjUImniVslZfWPnJuuZ.png"}]}},created:function(){this.form.getFieldDecorator("licenseFileArr",{initialValue:[],preserve:!0})},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,r){e||t.$notification["error"]({message:"Received values of form:",description:r})})},validate:function(e,t,r){var a=/^user-(.*)$/;a.test(t)||r(new Error("需要以 user- 开头")),r()},normFile:function(e){return console.log("Upload event:",e),w()(e)?e:e&&e.fileList},parseFile:function(e){if(!e)return[];var t=JSON.parse(e);return t.map(function(e){return e.status="done",e.url="http://".concat(location.host,"/api/file/download?id=").concat(e.uid,"&name=").concat(e.name),e})},edit:function(e){var t=this;this.form.resetFields(),e.licenseFile=this.parseFile(e.licenseFile),e.craftFile=this.parseFile(e.craftFile),e.pipeFile=this.parseFile(e.pipeFile),e.issSheetFile=this.parseFile(e.issSheetFile),setTimeout(function(){t.form.setFieldsValue(Object(s["a"])({},e))},50)}}},x=F,A=(r("fcfc"),r("2877")),I=Object(A["a"])(x,y,g,!1,null,"28906244",null),S=I.exports,T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"记录日期"}},[r("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["dischargeDate",{rules:[{required:!0,message:"请输入记录日期"}]}],expression:"[ 'dischargeDate', {rules: [{ required: true, message: '请输入记录日期'}]} ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入记录日期"}})],1)],1),r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"污水排放频次(每月)"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["monthResTimes",{rules:[{required:!0,message:"请输入污水排放频次"}]}],expression:"[ 'monthResTimes', {rules: [{ required: true, message: '请输入污水排放频次' }]} ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入污水排放频次"}})],1)],1),r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"单次排放量"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["monthResAmount",{rules:[{required:!0,message:"请输入单次排放量"}]}],expression:"[ 'monthResAmount', {rules: [{ required: true, message: '请输入单次排放量'}]} ]"}],attrs:{placeholder:"请输入单次排放量"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("吨\n          ")])])],1)],1),r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"月排放量"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["monthTotalAmount",{rules:[{required:!0,message:"请输入月排放量"}]}],expression:"[ 'monthTotalAmount', {rules: [{ required: true, message: '请输入月排放量'}]} ]"}],attrs:{placeholder:"请输入月排放量"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("吨\n          ")])])],1)],1)],1),r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"排放方式"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["emissionTypeID",{rules:[{required:!0,message:"请选择排放方式"}]}],expression:"['emissionTypeID',\n                              {rules: [{ required: true, message: '请选择排放方式'}]}\n                            ]"}],attrs:{placeholder:"请选择排放方式"}},e._l(e.paifangDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"收集方式"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["collTypeID",{rules:[{required:!0,message:"请选择责任人"}]}],expression:"[ 'collTypeID',\n                  {rules: [{ required: true, message: '请选择责任人'}]}\n                ]"}],attrs:{placeholder:"请选择收集方式"}},e._l(e.shoujiDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-form-item",{attrs:{label:"排查点位"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkPointIdList",{rules:[{required:!0,message:"请选择排查点位"}]}],expression:"[ 'chkPointIdList',\n                  {rules: [{ required: true, message: '请选择排查点位'}]}\n                ]"}],attrs:{placeholder:"排查点位",mode:"multiple"}},e._l(e.dianweiDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1)],1)},_=[],D={name:"TaskForm",props:{showSubmit:{type:Boolean,default:!1},paifangDicArr:{type:Array},shoujiDicArr:{type:Array},dianweiDicArr:{type:Array}},data:function(){return{form:this.$form.createForm(this)}},methods:{handleSubmit:function(e){e.preventDefault()},edit:function(e){var t=this;this.form.resetFields(),setTimeout(function(){t.form.setFieldsValue(Object(s["a"])({},e))},50)}}},L=D,q=Object(A["a"])(L,T,_,!1,null,"3d87d674",null),N=q.exports,$=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.memberLoading},scopedSlots:e._u([{key:"medTypeId",fn:function(t,a,i){return[r("a-select",{staticStyle:{width:"100%"},model:{value:a.medTypeId,callback:function(t){e.$set(a,"medTypeId",t)},expression:"record.medTypeId"}},e._l(e.yaopinDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)]}},{key:"monthAmmount",fn:function(t,a,i){return[r("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,step:1},model:{value:a.monthAmmount,callback:function(t){e.$set(a,"monthAmmount",t)},expression:"record.monthAmmount"}})]}},{key:"operation",fn:function(t,a,i){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(i)}}},[r("a",[e._v("删除")])])]}}])}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)},C=[],P={name:"YaoPin",props:{yaopinDicArr:Array},components:{},data:function(){return{form:null,memberLoading:!1,columns:[{title:"药品",dataIndex:"medTypeId",width:"20%",scopedSlots:{customRender:"medTypeId"}},{title:"月购置量",dataIndex:"monthAmmount",width:"30%",scopedSlots:{customRender:"monthAmmount"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],errors:[]}},created:function(){this.form=this.$form.createForm(this)},methods:{edit:function(e){this.data=e.map(function(e,t){return e.key=t,e})},handleSubmit:function(e){e.preventDefault(),this.form.validateFields(function(e,t){})},handleAdd:function(){this.data.push({medTypeId:null,monthAmmount:null})},remove:function(e){this.data.splice(e,1)}}},j=P,V=(r("a179"),Object(A["a"])(j,$,C,!1,null,"72fcd342",null)),E=V.exports,R=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.memberLoading},scopedSlots:e._u([e._l(["name","workId","department"],function(t,a){return{key:t,fn:function(i,n){return[n.editable?r("a-input",{key:t,staticStyle:{margin:"-5px 0"},attrs:{value:i,placeholder:e.columns[a].title},on:{change:function(r){return e.handleChange(r.target.value,n.key,t)}}}):[e._v(e._s(i))]]}}}),{key:"poluTypeId",fn:function(t,a){return[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["poluTypeId",{rules:[{required:!0,message:"请选择废水类型"}]}],expression:"[\n                        'poluTypeId',\n                        {rules: [{ required: true, message: '请选择废水类型'}]}\n                      ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择因子"},model:{value:a.poluTypeId,callback:function(t){e.$set(a,"poluTypeId",t)},expression:"record.poluTypeId"}},e._l(e.yinziDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)]}},{key:"unit",fn:function(t,a,i){return[r("a-input",{staticStyle:{width:"100%"},model:{value:a.unit,callback:function(t){e.$set(a,"unit",t)},expression:"record.unit"}})]}},{key:"emissionStdType",fn:function(t,a){return[r("a-input",{staticStyle:{width:"100%"},model:{value:a.emissionStdType,callback:function(t){e.$set(a,"emissionStdType",t)},expression:"record.emissionStdType"}})]}},{key:"operation",fn:function(t,a,i){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(i)}}},[r("a",[e._v("删除")])])]}}],null,!0)}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)},O=[],U=(r("6b54"),{name:"PpluType",props:{yinziDicArr:Array},components:{},data:function(){return{loading:!1,memberLoading:!1,columns:[{title:"污染因子",dataIndex:"poluTypeId",width:"20%",scopedSlots:{customRender:"poluTypeId"}},{title:"排放限值(单位）",dataIndex:"unit",width:"20%",scopedSlots:{customRender:"unit"}},{title:"排放标准名称(单位）",dataIndex:"emissionStdType",scopedSlots:{customRender:"emissionStdType"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],errors:[]}},methods:{edit:function(e){this.data=e.map(function(e,t){return e.key=t,e})},handleSubmit:function(e){e.preventDefault(),this.form.validateFields(function(e,t){})},handleAdd:function(){var e=this.data.length;this.data.push({key:0===e?"1":(v()(this.data[e-1].key)+1).toString(),poluTypeId:null,unit:null,emissionStdType:null})},remove:function(e){this.data.splice(e,1)}}}),z=U,B=(r("aef7"),Object(A["a"])(z,R,O,!1,null,"579af073",null)),J=B.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[e._l(e.form.getFieldValue("keys"),function(t,a){return r("a-form-item",{key:t,attrs:{required:!1}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["names["+t+"]",{validateTrigger:["change","blur"],preserve:!0,rules:[{required:!0,whitespace:!0,message:"Please input passenger's name or delete this field."}]}],expression:"[\n   `names[${k}]`,\n   {\n     validateTrigger: ['change', 'blur'],\n     preserve: true,\n     rules: [{\n       required: true,\n       whitespace: true,\n       message: 'Please input passenger\\'s name or delete this field.',\n     }],\n   }\n ]"}],staticStyle:{width:"60%","margin-right":"8px"},attrs:{placeholder:"passenger name"}}),e.form.getFieldValue("keys").length>1?r("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===e.form.getFieldValue("keys").length},on:{click:function(){return e.remove(t)}}}):e._e()],1)}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")]),r("a-form-item",[r("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v("\n            Submit\n        ")])],1)],2)},Y=[],G=r("795b"),W=r.n(G),Z={name:"YaoPin",props:{yaopinDicArr:Array},components:{},data:function(){return{form:null,memberLoading:!1,columns:[{title:"药品",dataIndex:"medTypeId",width:"20%",scopedSlots:{customRender:"medTypeId"}},{title:"月购置量",dataIndex:"monthAmmount",width:"30%",scopedSlots:{customRender:"monthAmmount"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],errors:[]}},created:function(){this.form=this.$form.createForm(this),this.form.getFieldDecorator("keys",{initialValue:[],preserve:!0}),this.form.getFieldDecorator("names",{initialValue:[],preserve:!0})},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,r){e||t.$notification["error"]({message:"Received values of form:",description:r})})},handleAdd:function(){var e=this.form,t=e.getFieldValue("keys"),r=t.concat(t.length);e.setFieldsValue({keys:r});var a=this.data.length,i=0===a?"1":(v()(this.data[a-1].key)+1).toString();this.data.push({key:i,medTypeId:null,monthAmmount:null})},remove:function(e){var t=this.form,r=t.getFieldValue("keys");1!==r.length&&t.setFieldsValue({keys:r.filter(function(e){return e!==k})})},saveRow:function(e){var t=this;this.memberLoading=!0;var r=e.key,a=e.name,i=e.workId,n=e.department;if(!a||!i||!n)return this.memberLoading=!1,void this.$message.error("请填写完整成员信息。");new W.a(function(e){setTimeout(function(){e({loop:!1})},800)}).then(function(){var e=t.data.filter(function(e){return e.key===r})[0];e.editable=!1,e.isNew=!1,t.memberLoading=!1})},toggle:function(e){var t=this.data.filter(function(t){return t.key===e})[0];t.editable=!t.editable},getRowByKey:function(e,t){var r=this.data;return(t||r).filter(function(t){return t.key===e})[0]},cancel:function(e){var t=this.data.filter(function(t){return t.key===e})[0];t.editable=!1},handleChange:function(e,t,r){var a=Object(f["a"])(this.data),i=a.filter(function(e){return t===e.key})[0];i&&(i[r]=e,this.data=a)}}},K=Z,H=(r("24d0"),Object(A["a"])(K,M,Y,!1,null,"ea098e8e",null)),Q=H.exports,X=r("5a70"),ee=r("ac0d"),te=r("365c"),re=r("c1df"),ae=r.n(re),ie={name:"仓库名",url:"仓库域名",owner:"仓库管理员",approver:"审批人",dateRange:"生效日期",type:"仓库类型",name2:"任务名",url2:"任务描述",owner2:"执行人",approver2:"责任人",dateRange2:"生效日期",type2:"任务类型"},ne={name:"CompanyEditIndex",mixins:[ee["b"],ee["c"]],components:{FooterToolBar:X["a"],BaseInfo:S,WaterInfo:N,YaoPin:E,PoluType:J,Test:Q},data:function(){return{description:"录入企业相关的所有信息",loading:!1,memberLoading:!1,errors:[],dicArr:[],yaopinDicArr:[],yinziDicArr:[],waterDicArr:[],paifangDicArr:[],shoujiDicArr:[],dianweiDicArr:[],mdl:{}}},watch:{$route:function(e,t){e.query.id!=t.query.id&&console.log(e,t)}},created:function(){this.getDic(),this.getData()},methods:{getData:function(){var e=this,t=this.$route.query.id;t?te["b"].GetForEdit(t).then(function(t){e.mdl=t.result,e.mdl.companyInfo.dischargeDate&&(e.mdl.companyInfo.dischargeDate=ae()(e.mdl.companyInfo.dischargeDate)),e.mdl.companyInfo.chkPointIdList&&(e.mdl.companyInfo.chkPointIdList=e.mdl.companyInfo.chkPointIdList.split(",").map(function(e){return v()(e)})),e.$refs.baseInfoForm.edit(e.mdl.companyInfo),e.$refs.waterInfoForm.edit(e.mdl.companyInfo),e.$refs.yaopinTable.edit(e.mdl.companyMedcineTypeList),e.$refs.poluTypeTable.edit(e.mdl.companyPoluTypeList)}):this.clearData()},clearData:function(){var e=this;this.$nextTick(function(){e.$refs.baseInfoForm.form.resetFields(),e.$refs.waterInfoForm.form.resetFields(),e.$refs.yaopinTable.edit([]),e.$refs.poluTypeTable.edit([])})},getDic:function(){var e=this;te["c"].GetAllItem().then(function(t){e.dicArr=t.result,e.yaopinDicArr=e.dicArr.filter(function(e){return"yaopin"==e.typeCode}),e.yinziDicArr=e.dicArr.filter(function(e){return"yinzixinxi"==e.typeCode}),e.waterDicArr=e.dicArr.filter(function(e){return"feishuileixing"==e.typeCode}),e.shoujiDicArr=e.dicArr.filter(function(e){return"shoujifangshi"==e.typeCode}),e.paifangDicArr=e.dicArr.filter(function(e){return"paifangfangshi"==e.typeCode}),e.dianweiDicArr=e.dicArr.filter(function(e){return"dianweixinxi"==e.typeCode})})},handleSubmit:function(e){e.preventDefault()},handleChange:function(e,t,r){var a=Object(f["a"])(this.data),i=a.filter(function(e){return t===e.key})[0];i&&(i[r]=e,this.data=a)},checkTableData:function(e,t,r){if(!e||!e.length)return!0;var a=!0,i=!1,n=void 0;try{for(var o,s=p()(e);!(a=(o=s.next()).done);a=!0){var l=o.value;if(""===l[t]||null===l[t]||void 0===l[t])return this.$notification.warn({message:"提示",description:r}),!1}}catch(c){i=!0,n=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}return!0},getUploadFile:function(e){if(!e||!e.length)return null;var t=e.map(function(e){return e.response?e.response.result:e});return d()(t)},validate:function(){var e=this,t=this.$refs,r=t.baseInfoForm,a=t.waterInfoForm,i=t.yaopinTable,n=t.poluTypeTable,o=this.$notification,l=n.data,u=i.data;r.form.validateFields(function(t,i){if(i.licenseFile=e.getUploadFile(i.licenseFile),i.craftFile=e.getUploadFile(i.craftFile),i.pipeFile=e.getUploadFile(i.pipeFile),i.issSheetFile=e.getUploadFile(i.issSheetFile),t){var n=c()({},r.form.getFieldsError()),d=Object(s["a"])({},n);e.errorList(d)}else a.form.validateFields(function(t,r){if(t){var n=c()({},a.form.getFieldsError()),d=Object(s["a"])({},n);e.errorList(d)}else if(e.checkTableData(l,"poluTypeId","排查点位因子数据不完整，请调整！")&&e.checkTableData(u,"medTypeId","药品数据不完整，请调整！")){r.chkPointIdList=r.chkPointIdList.join(",");var m={companyInfo:c()(e.mdl.companyInfo,i,r),companyPoluTypeList:l,companyMedcineTypeList:u};return te["b"].SaveForEdit(m).then(function(t){e.$message.info("保存成功"),e.$router.go(-1)}).catch(function(e){o.error({message:"保存失败，请稍后重试！",description:e.message})})}})})},errorList:function(e){if(!e||0===e.length)return null;this.errors=o()(e).map(function(t){return e[t]?{key:t,message:e[t][0],fieldLabel:ie[t]}:null})},scrollToField:function(e){var t=document.querySelector('label[for="'.concat(e,'"]'));t&&t.scrollIntoView(!0)}}},oe=ne,se=(r("d605"),Object(A["a"])(oe,a,i,!1,null,"4af155bb",null));t["default"]=se.exports},e659:function(e,t,r){},f409:function(e,t,r){},f499:function(e,t,r){e.exports=r("a21f")},fcfc:function(e,t,r){"use strict";var a=r("251e"),i=r.n(a);i.a}}]);