(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4b3fb434"],{"3b0e":function(e,t,r){},"75fc":function(e,t,r){"use strict";var n=r("a745"),a=r.n(n);function o(e){if(a()(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}var i=r("774e"),s=r.n(i),c=r("c8bb"),l=r.n(c);function u(e){if(l()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return s()(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){return o(e)||u(e)||d()}r.d(t,"a",function(){return m})},"774e":function(e,t,r){e.exports=r("d2d5")},a356:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-card",{staticClass:"card",attrs:{title:"",bordered:!1}},[r("check-info",{ref:"checkInfoForm",attrs:{companyArr:e.companyArr,dianweiDicArr:e.dianweiDicArr}})],1),r("a-card",{attrs:{title:""}},[r("check-item",{ref:"checkItemTable"})],1),r("footer-tool-bar",{style:{width:e.isSideMenu()&&e.isDesktop()?"calc(100% - "+(e.sidebarOpened?256:80)+"px)":"100%"}},[r("span",{staticClass:"popover-wrapper"},[r("a-popover",{attrs:{title:"表单校验信息",overlayClassName:"antd-pro-pages-forms-style-errorPopover",trigger:"click",getPopupContainer:function(e){return e.parentNode}}},[r("template",{slot:"content"},e._l(e.errors,function(t){return r("li",{key:t.key,staticClass:"antd-pro-pages-forms-style-errorListItem",on:{click:function(r){return e.scrollToField(t.key)}}},[r("a-icon",{staticClass:"antd-pro-pages-forms-style-errorIcon",attrs:{type:"cross-circle-o"}}),r("div",{},[e._v(e._s(t.message))]),r("div",{staticClass:"antd-pro-pages-forms-style-errorField"},[e._v(e._s(t.fieldLabel))])],1)}),0),e.errors.length>0?r("span",{staticClass:"antd-pro-pages-forms-style-errorIcon"},[r("a-icon",{attrs:{type:"exclamation-circle"}}),e._v(e._s(e.errors.length)+"\n        ")],1):e._e()],2)],1),r("a-button",{directives:[{name:"action",rawName:"v-action",value:["create","update"],expression:"['create','update']"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:e.loading},on:{click:e.validate}},[e._v("提交")]),r("a-button",{attrs:{type:"default"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},a=[],o=(r("456d"),r("cebc")),i=(r("ac4d"),r("8a81"),r("ac6a"),r("75fc")),s=r("5a70"),c=r("ac0d"),l=r("365c"),u=r("c1df"),d=r.n(u),m=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.memberLoading},scopedSlots:e._u([{key:"poluTypeId",fn:function(t,n){return[r("a-select",{staticStyle:{width:"100%"},model:{value:n.poluTypeId,callback:function(t){e.$set(n,"poluTypeId",t)},expression:"record.poluTypeId"}},e._l(e.poluTypeArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)]}},{key:"concentration",fn:function(t,n){return[r("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,step:1},model:{value:n.concentration,callback:function(t){e.$set(n,"concentration",t)},expression:"record.concentration"}})]}},{key:"operation",fn:function(t,n,a){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(a)}}},[r("a",[e._v("删除")])])]}}])}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)},p=[],f=r("2b0e"),h=new f["a"],y={name:"CheckItem",data:function(){return{form:null,memberLoading:!1,columns:[{title:"因子",dataIndex:"poluTypeId",width:"20%",scopedSlots:{customRender:"poluTypeId"}},{title:"浓度",dataIndex:"concentration",width:"30%",scopedSlots:{customRender:"concentration"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],poluTypeArr:[]}},created:function(){var e=this;this.form=this.$form.createForm(this),h.$on("GetCompanyPoluType",function(t){e.poluTypeArr=t;var r=!0,n=!1,a=void 0;try{for(var o,i=e.data[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var s=o.value;s.poluTypeId=null}}catch(c){n=!0,a=c}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}})},methods:{edit:function(e){this.data=e.map(function(e,t){return e.key=(new Date).getTime(),e})},handleSubmit:function(e){e.preventDefault(),this.form.validateFields(function(e,t){})},handleAdd:function(){this.data.push({key:(new Date).getTime(),poluTypeId:null,concentration:null})},remove:function(e){this.data.splice(e,1)}}},v=y,g=r("2877"),b=Object(g["a"])(v,m,p,!1,null,null,null),k=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"企业"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["companyId",{rules:[{required:!0,message:"请选择企业"}]}],expression:"[ 'companyId',\n                      {rules: [{ required: true, message: '请选择企业'}]}\n                    ]"}],attrs:{placeholder:"请选择企业"},on:{change:e.handleCompanyChange}},e._l(e.companyArr,function(t){return r("a-select-option",{key:t.id,attrs:{chkPointId:t.chkPointIdList,value:t.id},on:{change:e.handleCompanyChange}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"排查点位"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkPointId",{rules:[{required:!0,message:"请选择排查点位"}]}],expression:"[ 'chkPointId',\n                      {rules: [{ required: true, message: '请选择排查点位'}]}\n                    ]"}],attrs:{placeholder:"排查点位"}},e._l(e.chkPointArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1)],1),r("a-row",{staticClass:"form-row",attrs:{gutter:16}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"记录日期"}},[r("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkDate",{rules:[{required:!0,message:"请输入记录日期"}]}],expression:"[ 'chkDate', {rules: [{ required: true, message: '请输入记录日期'}]} ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入记录日期"}})],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"记录员"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkUserName",{rules:[{required:!0,message:"请输入记录员"}]}],expression:"[ 'chkUserName',\n                              {rules: [{ required: true, message: '请输入记录员'}]}\n                            ]"}],attrs:{placeholder:"记录员"}})],1)],1)],1)],1)},I=[],T={name:"TaskForm",props:{showSubmit:{type:Boolean,default:!1},companyArr:{type:Array}},data:function(){return{form:this.$form.createForm(this),chkPointArr:[],poluTypeArr:[]}},created:function(){this.form.getFieldDecorator("chkUserName",{initialValue:this.$store.getters.nickname}),this.form.getFieldDecorator("chkDate",{initialValue:d()()})},methods:{handleSubmit:function(e){e.preventDefault()},edit:function(e){var t=this;this.form.resetFields(),setTimeout(function(){t.form.setFieldsValue(Object(o["a"])({},e))},50)},handleCompanyChange:function(e,t){var r=t.data.attrs.chkPointId||"0";this.form.setFieldsValue({chkPointId:null}),this.getChkPoint(r),this.getPoluType(e)},getChkPoint:function(e){var t=this;l["c"].GetAllItem({idList:e}).then(function(e){t.chkPointArr=e.result.filter(function(e){return"dianweixinxi"==e.typeCode})})},getPoluType:function(e){var t=this;l["b"].GetPoluType({id:e}).then(function(e){t.poluTypeArr=e.result,h.$emit("GetCompanyPoluType",t.poluTypeArr)})}}},C=T,_=Object(g["a"])(C,w,I,!1,null,"771df578",null),x=_.exports,A={name:"CompanyEditIndex",mixins:[c["b"],c["c"]],components:{FooterToolBar:s["a"],CheckItem:k,CheckInfo:x},data:function(){return{description:"录入排查数据",loading:!1,memberLoading:!1,errors:[],dicArr:[],dianweiDicArr:[],companyArr:[]}},created:function(){this.getCompanyInfo()},methods:{clearData:function(){this.$nextTick(function(){})},getCompanyInfo:function(){var e=this;return l["b"].GetAllItem().then(function(t){e.companyArr=t.result})},handleSubmit:function(e){e.preventDefault()},handleChange:function(e,t,r){var n=Object(i["a"])(this.data),a=n.filter(function(e){return t===e.key})[0];a&&(a[r]=e,this.data=n)},checkTableData:function(e,t,r){if(!e||!e.length)return!0;var n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var c=i.value;if(""===c[t]||null===c[t]||void 0===c[t])return this.$notification.warn({message:"提示",description:r}),!1}}catch(l){a=!0,o=l}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return!0},getUploadFile:function(e){if(!e||!e.length)return null;var t=e.map(function(e){return e.response?e.response.result:e});return JSON.stringify(t)},validate:function(){var e=this,t=this.$refs,r=t.checkInfoForm,n=t.checkItemTable,a=this.$notification,i=n.data;r.form.validateFields(function(t,s){if(t){var c=Object.assign({},r.form.getFieldsError()),u=Object(o["a"])({},c);e.errorList(u)}else if(0!=i.length){if(e.checkTableData(i,"poluTypeId","因子数据不完整，请调整！"))return s.poluTypeList=i,l["a"].SaveForEdit(s).then(function(t){e.$message.info("保存成功"),n.edit([])}).catch(function(e){a.error({message:"保存失败，请稍后重试！",description:e.message})})}else e.$notification.warn({message:"未填写因子排查数据"})})},errorList:function(e){if(!e||0===e.length)return null;this.errors=Object.keys(e).map(function(t){return e[t]?{key:t,message:e[t][0]}:null})},scrollToField:function(e){var t=document.querySelector('label[for="'.concat(e,'"]'));t&&t.scrollIntoView(!0)}}},S=A,F=(r("c2a0"),Object(g["a"])(S,n,a,!1,null,"00731411",null));t["default"]=F.exports},c2a0:function(e,t,r){"use strict";var n=r("3b0e"),a=r.n(n);a.a},c8bb:function(e,t,r){e.exports=r("54a1")}}]);