(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16ce50bb"],{"079d":function(e,t,r){},5862:function(e,t,r){},"75fc":function(e,t,r){"use strict";var a=r("a745"),i=r.n(a);function n(e){if(i()(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}var o=r("774e"),s=r.n(o),l=r("c8bb"),c=r.n(l);function u(e){if(c()(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return s()(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(e){return n(e)||u(e)||d()}r.d(t,"a",function(){return m})},"774e":function(e,t,r){e.exports=r("d2d5")},a179:function(e,t,r){"use strict";var a=r("5862"),i=r.n(a);i.a},aef7:function(e,t,r){"use strict";var a=r("e659"),i=r.n(a);i.a},b149:function(e,t,r){},c731:function(e,t,r){"use strict";var a=r("f64a"),i=r.n(a);i.a},c8bb:function(e,t,r){e.exports=r("54a1")},d144:function(e,t,r){"use strict";var a=r("079d"),i=r.n(a);i.a},d616:function(e,t,r){"use strict";var a=r("b149"),i=r.n(a);i.a},d9ad:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-card",{staticClass:"card",attrs:{title:"基本信息",bordered:!1}},[r("base-info",{ref:"baseInfoForm",attrs:{showSubmit:!1,waterDicArr:e.waterDicArr}})],1),r("a-card",{staticClass:"card",attrs:{title:"排污信息",bordered:!1}},[r("water-info",{ref:"waterInfoForm",attrs:{showSubmit:!1,paifangDicArr:e.paifangDicArr,shoujiDicArr:e.shoujiDicArr,dianweiDicArr:e.dianweiDicArr,contaminantsDicArr:e.contaminantsDicArr}})],1),r("a-card",{attrs:{title:"污染因子"}},[r("polu-type",{ref:"poluTypeTable",attrs:{yinziDicArr:e.yinziDicArr}})],1),r("a-card",{attrs:{title:"药品及污染源购置台账"}},[r("yao-pin",{ref:"yaopinTable",attrs:{yaopinDicArr:e.yaopinDicArr}})],1),r("footer-tool-bar",{style:{width:e.isSideMenu()&&e.isDesktop()?"calc(100% - "+(e.sidebarOpened?256:80)+"px)":"100%"}},[r("span",{staticClass:"popover-wrapper"},[r("a-popover",{attrs:{title:"表单校验信息",overlayClassName:"antd-pro-pages-forms-style-errorPopover",trigger:"click",getPopupContainer:function(e){return e.parentNode}}},[r("template",{slot:"content"},e._l(e.errors,function(t){return r("li",{key:t.key,staticClass:"antd-pro-pages-forms-style-errorListItem",on:{click:function(r){return e.scrollToField(t.key)}}},[r("a-icon",{staticClass:"antd-pro-pages-forms-style-errorIcon",attrs:{type:"cross-circle-o"}}),r("div",{},[e._v(e._s(t.message))]),r("div",{staticClass:"antd-pro-pages-forms-style-errorField"},[e._v(e._s(t.fieldLabel))])],1)}),0),e.errors.length>0?r("span",{staticClass:"antd-pro-pages-forms-style-errorIcon"},[r("a-icon",{attrs:{type:"exclamation-circle"}}),e._v(e._s(e.errors.length)+"\n        ")],1):e._e()],2)],1),r("a-button",{directives:[{name:"action",rawName:"v-action",value:["create","update"],expression:"['create','update']"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary",loading:e.loading},on:{click:e.validate}},[e._v("提交")]),r("a-button",{attrs:{type:"default"},on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)},i=[],n=(r("456d"),r("cebc")),o=(r("ac4d"),r("8a81"),r("ac6a"),r("75fc")),s=(r("28a5"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-form-item",{attrs:{label:"企业名称"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入企业名称",whitespace:!0}]}],expression:"[\n                                  'name',\n                                  {rules: [{ required: true, message: '请输入企业名称', whitespace: true}]}\n                                ]"}],attrs:{placeholder:"请输入企业名称"}})],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"企业地址"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["address",{rules:[{required:!0,message:"请输入企业地址",whitespace:!0}]}],expression:"[\n                                  'address',\n                                  {rules: [{ required: true, message: '请输入企业地址', whitespace: true}]}\n                                ]"}],attrs:{placeholder:"请输入企业地址"}})],1)],1),r("a-col",{attrs:{md:6,sm:12}},[r("a-form-item",{attrs:{label:"经度"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["x"],expression:"[\n                                    'x'\n                                  ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入经度"}})],1)],1),r("a-col",{attrs:{md:6,sm:12}},[r("a-form-item",{attrs:{label:"纬度"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["y"],expression:"[\n                                    'y'\n                                  ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入经度"}})],1)],1)],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"企业联系人"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["contact",{rules:[{required:!0,message:"请输入企业联系人",whitespace:!0}]}],expression:"[\n                    'contact',\n                    {rules: [{ required: true, message: '请输入企业联系人', whitespace: true}]}\n                  ]"}],attrs:{placeholder:"请输入"}})],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"联系电话"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["tel",{rules:[{required:!0,message:"请输入联系电话",whitespace:!0}]}],expression:"[\n             'tel',\n             {rules: [{ required: true, message: '请输入联系电话', whitespace: true}]}\n           ]"}],attrs:{placeholder:"请输入联系电话"}})],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"排污许可证"}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["licenseFile",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:[{validator:e.validateFile}]}],expression:"['licenseFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\nrules: [{ validator: validateFile }]\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{xs:24,md:6}},[r("a-form-item",{attrs:{label:"废水类型"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["waterTypeID",{rules:[{required:!0,message:"请选择废水类型"}]}],expression:"[\n                    'waterTypeID',\n                    {rules: [{ required: true, message: '请选择废水类型'}]}\n                  ]"}],attrs:{placeholder:"请选择废水类型"}},e._l(e.waterDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-col",{attrs:{xs:24,md:6}},[r("a-form-item",{attrs:{label:"废水设施处理能力"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["waterAmountBz",{rules:[{required:!0,message:"请输入废水设施处理能力"}]}],expression:"[\n                 'waterAmountBz',\n                 {rules: [{ required: true, message: '请输入废水设施处理能力'}]}\n               ]"}],attrs:{placeholder:"请输入废水设施处理能力"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("m³/d\n            ")])])],1)],1),r("a-col",{attrs:{xs:24,md:6}},[r("a-form-item",{attrs:{label:"废水月处理量(批复)"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["planWaterAmount",{rules:[{required:!0,message:"请输入废水月处理量批复值"}]}],expression:"[\n                        'planWaterAmount',\n                        {rules: [{ required: true, message: '请输入废水月处理量批复值'}]}\n                      ]"}],attrs:{placeholder:"请输入废水月处理量批复值"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("m³/d\n            ")])])],1)],1),r("a-col",{attrs:{xs:24,md:6}},[r("a-form-item",{attrs:{label:"废水月处理量(实际)"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["factWaterAmount",{rules:[{required:!0,message:"请输入废水月处理量实际值"}]}],expression:"[\n                        'factWaterAmount',\n                        {rules: [{ required: true, message: '请输入废水月处理量实际值'}]}\n                      ]"}],attrs:{placeholder:"请输入废水月处理量实际值"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("m³/d\n            ")])])],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"污水处理工艺流程图",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["craftFile",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:[{validator:e.validateFile}]}],expression:"['craftFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\nrules: [{ validator: validateFile }]\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-form-item",{attrs:{label:"工艺流程说明（要说明污水分流情况）"}},[r("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["craftDes"],expression:"[\n                      'craftDes'\n                    ]"}],attrs:{placeholder:""}})],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"污水管网图",extra:""}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["pipeFile",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:[{validator:e.validateFile}]}],expression:"['pipeFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\nrules: [{ validator: validateFile }]\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-row",{attrs:{gutter:8}},[r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"环责险购买情况（保额）"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["envInsuredAmount",{rules:[{required:!0,message:"请输入环责险购买情况（保额）"}]}],expression:"[ 'envInsuredAmount', {rules: [{ required: true, message: '请输入环责险购买情况（保额）'}]} ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入环责险购买情况（保额）"}})],1)],1),r("a-col",{attrs:{md:6,sm:24}},[r("a-form-item",{attrs:{label:"环责险购买情况（期限）"}},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["envDeadline",{rules:[{required:!0,message:"请输入环责险购买情况（期限）"}]}],expression:"[ 'envDeadline', {rules: [{ required: true, message: '请输入环责险购买情况（期限）'}]} ]"}],attrs:{placeholder:"请输入环责险购买情况（期限）"}})],1)],1)],1),e.showSubmit?r("a-form-item",[r("a-button",{attrs:{htmlType:"submit"}},[e._v("保存")])],1):e._e()],1)}),l=[],c=(r("7f7f"),{name:"BaseInfo",props:{showSubmit:{type:Boolean,default:!1},waterDicArr:{type:Array}},data:function(){return{form:this.$form.createForm(this),formItemLayout:{labelCol:{md:2,align:"left",xs:24},wrapperCol:{md:14,offset:2,xs:24}},dicArr:[],fileList:[]}},created:function(){this.form.getFieldDecorator("licenseFileArr",{initialValue:[],preserve:!0})},methods:{handleSubmit:function(e){var t=this;e.preventDefault(),this.form.validateFields(function(e,r){e||t.$notification["error"]({message:"Received values of form:",description:r})})},validate:function(e,t,r){var a=/^user-(.*)$/;a.test(t)||r(new Error("需要以 user- 开头")),r()},normFile:function(e){return Array.isArray(e)?e:e&&e.fileList},parseFile:function(e){if(!e)return[];var t=JSON.parse(e);return t.filter(function(e){return null!=e}).map(function(e){return e.status="done",e.url="http://".concat(location.host,"/api/file/download?id=").concat(e.uid,"&name=").concat(e.name),e})},edit:function(e){var t=this;this.form.resetFields(),e.licenseFile=this.parseFile(e.licenseFile),e.craftFile=this.parseFile(e.craftFile),e.pipeFile=this.parseFile(e.pipeFile),e.issSheetFile=this.parseFile(e.issSheetFile),setTimeout(function(){t.form.setFieldsValue(Object(n["a"])({},e))},50)},validateFile:function(e,t,r){if(t){var a=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;if("error"==l.status){var c=l.size/1024/1024<10;if(!c)return void r(new Error("".concat(l.name," 不能超过 10M ")));r(new Error("".concat(l.name," 上传失败 ")))}if(l.percent<100)return void r(new Error("上传中..."))}}catch(u){i=!0,n=u}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}}r()}}}),u=c,d=(r("d144"),r("2877")),m=Object(d["a"])(u,s,l,!1,null,"0896b267",null),p=m.exports,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-row",{staticClass:"form-row"},[r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"污染物"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["contaminantsId",{rules:[{required:!0,message:"请选择污染物"}]}],expression:"[ 'contaminantsId',\n              {rules: [{ required: true, message: '请选择污染物'}]}\n            ]"}],attrs:{placeholder:"请选择污染物"}},e._l(e.contaminantsDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1),r("a-col",{attrs:{md:12,sm:24}},[r("a-form-item",{attrs:{label:"转移总量"}},[r("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:["transferTotal"],expression:"[\n                                          'transferTotal'\n                                        ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请输入转移总量"}},[r("span",{staticStyle:{width:"10px"},attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("吨/月\n            ")])])],1)],1)],1),r("a-form-item",e._b({staticStyle:{"text-align":"left"},attrs:{label:"原材料采购清单"}},"a-form-item",e.formItemLayout,!1),[r("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["purchaseFile",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:[{validator:e.validateFile}]}],expression:"['purchaseFile', {\nvaluePropName: 'fileList',\ngetValueFromEvent: normFile,\nrules: [{ validator: validateFile }]\n}]"}],attrs:{name:"files",action:"/api/File/Upload","list-type":"picture"}},[r("a-button",[r("a-icon",{attrs:{type:"upload"}}),e._v(" 点击上传\n        ")],1)],1)],1),r("a-form-item",{attrs:{label:"排查点位"}},[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["chkPointIdList",{rules:[{required:!0,message:"请选择排查点位"}]}],expression:"[ 'chkPointIdList',\n                    {rules: [{ required: true, message: '请选择排查点位'}]}\n                  ]"}],attrs:{placeholder:"排查点位",mode:"multiple"}},e._l(e.dianweiDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)],1)],1)},v=[],y={name:"TaskForm",props:{showSubmit:{type:Boolean,default:!1},paifangDicArr:{type:Array},shoujiDicArr:{type:Array},dianweiDicArr:{type:Array},contaminantsDicArr:{type:Array}},data:function(){return{form:this.$form.createForm(this),formItemLayout:{labelCol:{md:2,align:"left",xs:24},wrapperCol:{md:14,offset:2,xs:24}}}},created:function(){},methods:{handleSubmit:function(e){e.preventDefault()},edit:function(e){var t=this;this.form.resetFields(),e.purchaseFile=this.parseFile(e.purchaseFile),setTimeout(function(){t.form.setFieldsValue(Object(n["a"])({},e))},50)},normFile:function(e){return Array.isArray(e)?e:e&&e.fileList},parseFile:function(e){if(!e)return[];var t=JSON.parse(e);return t.filter(function(e){return null!=e}).map(function(e){return e.status="done",e.url="http://".concat(location.host,"/api/file/download?id=").concat(e.uid,"&name=").concat(e.name),e})},validateFile:function(e,t,r){if(t){var a=!0,i=!1,n=void 0;try{for(var o,s=t[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;if("error"==l.status){var c=l.size/1024/1024<10;if(!c)return void r(new Error("".concat(l.name," 不能超过 10M ")));r(new Error("".concat(l.name," 上传失败 ")))}if(l.percent<100)return void r(new Error("上传中..."))}}catch(u){i=!0,n=u}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}}r()}}},h=y,b=(r("d616"),Object(d["a"])(h,f,v,!1,null,"4f8bfaf6",null)),g=b.exports,w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form",{staticClass:"form",attrs:{form:e.form},on:{submit:e.handleSubmit}},[r("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.memberLoading},scopedSlots:e._u([{key:"medTypeId",fn:function(t,a,i){return[r("a-select",{staticStyle:{width:"100%"},model:{value:a.medTypeId,callback:function(t){e.$set(a,"medTypeId",t)},expression:"record.medTypeId"}},e._l(e.yaopinDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)]}},{key:"monthAmmount",fn:function(t,a,i){return[r("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2,step:1},model:{value:a.monthAmmount,callback:function(t){e.$set(a,"monthAmmount",t)},expression:"record.monthAmmount"}})]}},{key:"operation",fn:function(t,a,i){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(i)}}},[r("a",[e._v("删除")])])]}}])}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)},F=[],A={name:"YaoPin",props:{yaopinDicArr:Array},components:{},data:function(){return{form:null,memberLoading:!1,columns:[{title:"药品",dataIndex:"medTypeId",width:"20%",scopedSlots:{customRender:"medTypeId"}},{title:"月购置量",dataIndex:"monthAmmount",width:"30%",scopedSlots:{customRender:"monthAmmount"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],errors:[]}},created:function(){this.form=this.$form.createForm(this)},methods:{edit:function(e){this.data=e.map(function(e,t){return e.key=t,e})},handleSubmit:function(e){e.preventDefault(),this.form.validateFields(function(e,t){})},handleAdd:function(){this.data.push({medTypeId:null,monthAmmount:null})},remove:function(e){this.data.splice(e,1)}}},x=A,I=(r("a179"),Object(d["a"])(x,w,F,!1,null,"72fcd342",null)),S=I.exports,D=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-table",{attrs:{columns:e.columns,dataSource:e.data,pagination:!1,loading:e.memberLoading},scopedSlots:e._u([e._l(["name","workId","department"],function(t,a){return{key:t,fn:function(i,n){return[n.editable?r("a-input",{key:t,staticStyle:{margin:"-5px 0"},attrs:{value:i,placeholder:e.columns[a].title},on:{change:function(r){return e.handleChange(r.target.value,n.key,t)}}}):[e._v(e._s(i))]]}}}),{key:"poluTypeId",fn:function(t,a){return[r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["poluTypeId",{rules:[{required:!0,message:"请选择废水类型"}]}],expression:"[\n                        'poluTypeId',\n                        {rules: [{ required: true, message: '请选择废水类型'}]}\n                      ]"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择因子"},model:{value:a.poluTypeId,callback:function(t){e.$set(a,"poluTypeId",t)},expression:"record.poluTypeId"}},e._l(e.yinziDicArr,function(t){return r("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}),1)]}},{key:"unit",fn:function(t,a,i){return[r("a-input",{staticStyle:{width:"100%"},model:{value:a.unit,callback:function(t){e.$set(a,"unit",t)},expression:"record.unit"}})]}},{key:"emissionStdType",fn:function(t,a){return[r("a-input",{staticStyle:{width:"100%"},model:{value:a.emissionStdType,callback:function(t){e.$set(a,"emissionStdType",t)},expression:"record.emissionStdType"}})]}},{key:"operation",fn:function(t,a,i){return[r("a-popconfirm",{attrs:{title:"是否要删除此行？"},on:{confirm:function(t){return e.remove(i)}}},[r("a",[e._v("删除")])])]}}],null,!0)}),r("a-button",{staticStyle:{width:"100%","margin-top":"16px","margin-bottom":"8px"},attrs:{type:"dashed",icon:"plus"},on:{click:e.handleAdd}},[e._v("新增")])],1)},T=[],_=(r("6b54"),{name:"PpluType",props:{yinziDicArr:Array},components:{},data:function(){return{loading:!1,memberLoading:!1,columns:[{title:"污染因子",dataIndex:"poluTypeId",width:"20%",scopedSlots:{customRender:"poluTypeId"}},{title:"排放限值(单位）",dataIndex:"unit",width:"20%",scopedSlots:{customRender:"unit"}},{title:"排放标准名称(单位）",dataIndex:"emissionStdType",scopedSlots:{customRender:"emissionStdType"}},{title:"操作",key:"action",scopedSlots:{customRender:"operation"}}],data:[],errors:[]}},methods:{edit:function(e){this.data=e.map(function(e,t){return e.key=t,e})},handleSubmit:function(e){e.preventDefault(),this.form.validateFields(function(e,t){})},handleAdd:function(){var e=this.data.length;this.data.push({key:0===e?"1":(parseInt(this.data[e-1].key)+1).toString(),poluTypeId:null,unit:null,emissionStdType:null})},remove:function(e){this.data.splice(e,1)}}}),k=_,L=(r("aef7"),Object(d["a"])(k,D,T,!1,null,"579af073",null)),N=L.exports,$=r("5a70"),q=r("ac0d"),C=r("365c"),E=r("c1df"),j=r.n(E),P={},O={name:"CompanyEditIndex",mixins:[q["b"],q["c"]],components:{FooterToolBar:$["a"],BaseInfo:p,WaterInfo:g,YaoPin:S,PoluType:N},data:function(){return{description:"录入企业相关的所有信息",loading:!1,memberLoading:!1,errors:[],dicArr:[],yaopinDicArr:[],yinziDicArr:[],waterDicArr:[],paifangDicArr:[],shoujiDicArr:[],dianweiDicArr:[],contaminantsDicArr:[],mdl:{}}},watch:{$route:function(e,t){e.query.id!=t.query.id&&console.log(e,t)}},created:function(){this.mdl=null,this.getDic(),this.getData()},methods:{getData:function(){var e=this,t=this.$route.query.id;t?C["b"].GetForEdit(t).then(function(t){e.mdl=t.result,e.mdl.companyInfo.dischargeDate&&(e.mdl.companyInfo.dischargeDate=j()(e.mdl.companyInfo.dischargeDate)),e.mdl.companyInfo.chkPointIdList&&(e.mdl.companyInfo.chkPointIdList=e.mdl.companyInfo.chkPointIdList.split(",").map(function(e){return parseInt(e)})),e.$refs.baseInfoForm.edit(e.mdl.companyInfo),e.$refs.waterInfoForm.edit(e.mdl.companyInfo),e.$refs.yaopinTable.edit(e.mdl.companyMedcineTypeList),e.$refs.poluTypeTable.edit(e.mdl.companyPoluTypeList)}):this.clearData()},clearData:function(){var e=this;this.$nextTick(function(){e.$refs.baseInfoForm.form.resetFields(),e.$refs.waterInfoForm.form.resetFields(),e.$refs.yaopinTable.edit([]),e.$refs.poluTypeTable.edit([])})},getDic:function(){var e=this;C["c"].GetAllItem().then(function(t){e.dicArr=t.result,e.yaopinDicArr=e.dicArr.filter(function(e){return"yaopin"==e.typeCode}),e.yinziDicArr=e.dicArr.filter(function(e){return"yinzixinxi"==e.typeCode}),e.waterDicArr=e.dicArr.filter(function(e){return"feishuileixing"==e.typeCode}),e.shoujiDicArr=e.dicArr.filter(function(e){return"shoujifangshi"==e.typeCode}),e.paifangDicArr=e.dicArr.filter(function(e){return"paifangfangshi"==e.typeCode}),e.dianweiDicArr=e.dicArr.filter(function(e){return"dianweixinxi"==e.typeCode}),e.contaminantsDicArr=e.dicArr.filter(function(e){return"wuranwu"==e.typeCode})})},handleSubmit:function(e){e.preventDefault()},handleChange:function(e,t,r){var a=Object(o["a"])(this.data),i=a.filter(function(e){return t===e.key})[0];i&&(i[r]=e,this.data=a)},checkTableData:function(e,t,r){if(!e||!e.length)return!0;var a=!0,i=!1,n=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done);a=!0){var l=o.value;if(""===l[t]||null===l[t]||void 0===l[t])return this.$notification.warn({message:"提示",description:r}),!1}}catch(c){i=!0,n=c}finally{try{a||null==s.return||s.return()}finally{if(i)throw n}}return!0},getUploadFile:function(e){if(!e||!e.length)return null;var t=e.map(function(e){if("done"!=e.status)throw new Error("存在未成功上传的文件，请检查！");return e.response?e.response.result:e});return JSON.stringify(t)},validate:function(){var e=this,t=this.$refs,r=t.baseInfoForm,a=t.waterInfoForm,i=t.yaopinTable,o=t.poluTypeTable,s=this.$notification,l=o.data,c=i.data;r.form.validateFields(function(t,i){try{i.licenseFile=e.getUploadFile(i.licenseFile),i.craftFile=e.getUploadFile(i.craftFile),i.pipeFile=e.getUploadFile(i.pipeFile),i.issSheetFile=e.getUploadFile(i.issSheetFile)}catch(d){return void e.$message.warn(d.message)}if(t){var o=Object.assign({},r.form.getFieldsError()),u=Object(n["a"])({},o);e.errorList(u)}else a.form.validateFields(function(t,r){if(t){var o=Object.assign({},a.form.getFieldsError()),u=Object(n["a"])({},o);e.errorList(u)}else if(e.checkTableData(l,"poluTypeId","排查点位因子数据不完整，请调整！")&&e.checkTableData(c,"medTypeId","药品数据不完整，请调整！")){r.chkPointIdList=r.chkPointIdList.join(","),r.purchaseFile=e.getUploadFile(r.purchaseFile);var d=e.mdl?e.mdl.companyInfo:{},m={companyInfo:Object.assign(d,i,r),companyPoluTypeList:l,companyMedcineTypeList:c};return e.loading=!0,C["b"].SaveForEdit(m).then(function(t){e.$message.info("保存成功"),e.$route.query.id||e.$router.push({path:"/manage/company/edit",query:{id:t.result}})}).catch(function(e){s.error({message:"保存失败，请稍后重试！",description:e.message})}).finally(function(){e.loading=!1})}})})},errorList:function(e){if(!e||0===e.length)return null;this.errors=Object.keys(e).map(function(t){return e[t]?{key:t,message:e[t][0],fieldLabel:P[t]}:null})},scrollToField:function(e){var t=document.querySelector('label[for="'.concat(e,'"]'));t&&t.scrollIntoView(!0)}}},V=O,z=(r("c731"),Object(d["a"])(V,a,i,!1,null,"3fb12aaa",null));t["default"]=z.exports},e659:function(e,t,r){},f64a:function(e,t,r){}}]);